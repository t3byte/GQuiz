@page
@model GQuiz.Pages.Host.DashboardModel
@{
    ViewData["Title"] = "Host Dashboard";
}

<div class="dashboard-container">
    <div class="dashboard-header">
        <h1>📊 Host Dashboard</h1>
        <a asp-page="/Host/CreateQuiz" class="btn btn-primary">+ Create New Quiz</a>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-value">@Model.TotalQuizzes</div>
            <div class="stat-label">Total Quizzes</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">@Model.ActiveSessions</div>
            <div class="stat-label">Active Sessions</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">@Model.TotalParticipants</div>
            <div class="stat-label">Total Participants</div>
        </div>
    </div>

    <div class="section">
        <h2>Your Quizzes</h2>

        @if (Model.Quizzes.Any())
        {
            <div class="quiz-grid">
                @foreach (var quiz in Model.Quizzes)
                {
                    <div class="quiz-card">
                        <h3>@quiz.Title</h3>
                        <p>@quiz.Description</p>
                        <div class="quiz-meta">
                            <span>📝 @quiz.Questions.Count questions</span>
                            <span>📅 @quiz.CreatedAt.ToString("MMM dd, yyyy")</span>
                        </div>
                        <div class="quiz-actions">
                            <a asp-page="/Host/StartSession" asp-route-quizId="@quiz.Id" class="btn btn-success btn-sm">Start Session</a>
                            <a asp-page="/Host/EditQuiz" asp-route-id="@quiz.Id" class="btn btn-secondary btn-sm">Edit</a>
                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            <div class="empty-state">
                <p>No quizzes yet. Create your first quiz to get started!</p>
                <a asp-page="/Host/CreateQuiz" class="btn btn-primary">Create Quiz</a>
            </div>
        }
    </div>

    <div class="section">
        <h2>Recent Sessions</h2>

        @if (Model.RecentSessions.Any())
        {
            <div class="sessions-list">
                @foreach (var session in Model.RecentSessions)
                {
                    <div class="session-item">
                        <div class="session-info">
                            <h4>@session.Quiz.Title</h4>
                            <span class="session-code">Code: @session.SessionCode</span>
                            <span class="session-status status-@session.Status.ToString().ToLower()">@session.Status</span>
                        </div>
                        <div class="session-meta">
                            <span>👥 @session.Participants.Count participants</span>
                            <span>📅 @session.CreatedAt.ToString("MMM dd, HH:mm")</span>
                        </div>
                        <div class="session-actions">
                            @if (session.Status == SessionStatus.InProgress)
                            {
                                <a asp-page="/Host/ControlSession" asp-route-sessionId="@session.Id" class="btn btn-primary btn-sm">Control</a>
                            }
                            else if (session.Status == SessionStatus.Completed)
                            {
                                <a asp-page="/Host/SessionResults" asp-route-sessionId="@session.Id" class="btn btn-secondary btn-sm">View Results</a>
                            }
                            else if (session.Status == SessionStatus.NotStarted)
                            {
                                <a asp-page="/Host/ControlSession" asp-route-sessionId="@session.Id" class="btn btn-primary btn-sm">Resume</a>

                                <form method="post" asp-page-handler="Delete" style="display:inline-block; margin-left:8px;" onsubmit="return confirm('Delete this session? This cannot be undone.');">
                                    <input type="hidden" name="sessionId" value="@session.Id" />
                                    <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                                </form>
                            }
                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            <p class="text-muted">No recent sessions</p>
        }
    </div>
</div>